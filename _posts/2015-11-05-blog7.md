---
layout: default
title: 7. winphone下shader
comments: true
---

##
这些天一直在做winphone的移植，刚好我们的游戏里也用到了shader，之前的都是动态加载片段着色代码进行渲染，但是在winphone上
却发现被渲染的对象会出现错位或者花瓶，网上找了下，也没有什么完全靠谱的方案，很多都是说的模模糊糊，但最后自己还是解决了，
心确实非常高兴。

这里大致总结下过程：

1. cocos2dx 对winphone的支持，是通过google开源工程angleproject来把openGl Api转directer 3d Api的，但是cocos2dx 从设计以来
就假设了openGl 对所有平台都支持， 引擎里面，随处可以看到openGl的代码，shader也只动态加载直接来， 但是到了winphone上， 一
定的需要预编译好的shader， 这下cocos2dx 就傻眼了， 没办法，那就把他们编译成静态的吧

2. 到angel project 官网去下载编译二进制的shader exe文件（2dx也有带，但是有些版本没带），然后按着说明准备好你shader需要的
顶点代码， 片段代码，然后命令行下编译，就弄成了一个数组格式的 二进制文件，这就是预编译好的shader不

3. 把编译好的shader放到2dx源代码里面， 然后计算大小等等， 反正比较繁琐，最后还需要将顶点和片段代码弄成文本形式，供2dx加
载时使用，最后就是编译，测试，编译

大概就上面，详细的不想说太多， 最近加班特别多， 以前的衣服大了很多， 人瘦了很大一圈，感觉越加班效率越低！ 休息好了反而
效率更高，更快。 这个移植的项目因为底层封装修改确实比较大，导致移植和之前的预估上线的时间相差了很多，自己也挺难过的，
还好上司领导还是支持我弄完，不能对不起别人的信任，虽然之前弄得都想辞职了，但是后面想了下，还是坚持弄完他，虽然自己在这
件事情上不是很出色，但答应了就一定要做完，做好，也要对得起自己的时间！

在此，挺谢谢那些信任我的人，有他们的信任，我才可以坚持做下去
 
